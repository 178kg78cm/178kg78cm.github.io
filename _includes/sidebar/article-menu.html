<style type="text/css" media="screen">
  .post-menu {
    position: fixed;
    top: 100px;
    right: 20px;
    width: 250px;
    background: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
    font-family: Arial, sans-serif;
  }

  .post-menu-title {
    font-weight: bold;
    text-align: center;
    padding-bottom: 10px;
    border-bottom: 2px solid #ddd;
    font-size: 18px;
    color: #333;
  }

  .post-menu-content ul {
    list-style: none;
    padding: 0;
    margin: 10px 0;
  }

  .post-menu-content li {
    padding: 8px 5px;
    font-size: 14px;
    border-bottom: 1px solid #eee;
    transition: background 0.3s ease-in-out;
  }

  .post-menu-content li:last-child {
    border-bottom: none;
  }

  .post-menu-content li:hover {
    background: #e9ecef;
  }

  .post-menu-content li a {
    text-decoration: none;
    color: #007bff;
    display: block;
  }

  .post-menu-content li.active {
    font-weight: bold;
    color: #0056b3;
  }
</style>

<div class="post-menu">
  <div class="post-menu-title">Table of Contents</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent = menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4");

    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    var menuHTML = '';
    headings.forEach(function(h) {
      var id = h.getAttribute("id");
      if (id) {
        menuHTML += `<li class="h-${h.tagName.toLowerCase()}">
          <a href="#${id}">${h.textContent}</a></li>`;
      }
    });

    menuContent.innerHTML = `<ul>${menuHTML}</ul>`;

    // Smooth scroll
    document.querySelectorAll('.post-menu-content a').forEach(anchor => {
      anchor.addEventListener('click', function (event) {
        event.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      });
    });

    // Active menu highlight
    window.addEventListener("scroll", function () {
      var fromTop = window.scrollY + 100;
      var activeItem = null;

      headings.forEach((heading, index) => {
        if (heading.offsetTop <= fromTop) {
          activeItem = index;
        }
      });

      var links = document.querySelectorAll(".post-menu-content li");
      links.forEach((li, index) => {
        li.classList.toggle("active", index === activeItem);
      });
    });
  }

  generateContent();
</script>
